<app-cart></app-cart>

<form [formGroup]="checkoutForm" (ngSubmit)="sendForm()">
  <fieldset>
    <mat-form-field class="full-width">
      <mat-label>Imię</mat-label>
      <input matInput formControlName="firstName" />
      <mat-error *ngIf="firstNameCtrl.hasError('required')">
        Imię jest wymaganym polem </mat-error
      ><mat-error *ngIf="firstNameCtrl.hasError('minlength')">
        Imię musi się składać z minimum
        {{ firstNameCtrl.errors!["minlength"]["requiredLength"] }}
        znaków
      </mat-error> </mat-form-field
    ><mat-form-field>
      <mat-label>Nazwisko</mat-label
      ><input matInput formControlName="lastName" /><mat-error
        *ngIf="lastNameCtrl.hasError('required')"
      >
        Nazwisko jest wymaganym polem
      </mat-error>
      <mat-error *ngIf="lastNameCtrl.hasError('minlength')">
        Nazwisko musi się składać z minimum
        {{ lastNameCtrl.errors!["minlength"]["requiredLength"] }}
        znaków
      </mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Numer Telefonu</mat-label>
      <input
        type="tel"
        appNumbersOnly
        [inputLength]="9"
        matInput
        formControlName="phoneNumber"
      /><mat-error *ngIf="phoneNumberCtrl.hasError('required')">
        Numer telefonu jest wymaganym polem </mat-error
      ><mat-error *ngIf="phoneNumberCtrl.hasError('pattern')">
        Numer telefonu musi się składać z 9 cyfr
      </mat-error>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Adres email</mat-label>
      <input type="email" matInput formControlName="email" /><mat-error
        *ngIf="emailCtrl.hasError('required')"
      >
        Email jest wymaganym polem
      </mat-error>
      <mat-error *ngIf="emailCtrl.hasError('emailPattern')">
        Niewłaściwy format adresu email
      </mat-error> </mat-form-field
    ><mat-form-field>
      <mat-label>Potwierdź adres email</mat-label>
      <input type="email" matInput formControlName="confirmEmail" />
      <mat-error *ngIf="confirmEmailCtrl.errors" class="confirm-email-errors">
        <span *ngIf="confirmEmailCtrl.hasError('required')">
          {{ confirmEmailErrorMessages["required"] }}</span
        >
        <span *ngIf="confirmEmailCtrl.hasError('emailPattern')">
          {{ confirmEmailErrorMessages["pattern"] }}</span
        ><span *ngIf="confirmEmailCtrl.hasError('notMatch')">
          {{ confirmEmailErrorMessages["notMatch"] }}</span
        >
      </mat-error>
    </mat-form-field>

    <mat-slide-toggle
      [checked]="true"
      color="primary"
      formControlName="newsletter"
      >Chcę otrzymywać informacje o zniżkach i promocjach
    </mat-slide-toggle>

    <mat-form-field class="full-width mb-1">
      <mat-label>Kod zniżkowy</mat-label>
      <input matInput formControlName="couponCode" />

      <mat-error *ngIf="couponCodeCtrl.hasError('minlength')">
        Kod musi składać się z co najmniej
        {{ couponCodeCtrl.errors!["minlength"]["requiredLength"] }}
        znaków
      </mat-error>
      <mat-error
        *ngIf="couponCodeCtrl.errors && couponCodeCtrl.errors['couponInvalid']"
      >
        Nieprawidłowy kod
      </mat-error>
      <mat-error
        *ngIf="couponCodeCtrl.errors && couponCodeCtrl.errors['couponUsed']"
      >
        Kod wykorzystany </mat-error
      ><mat-hint
        class="color-success"
        *ngIf="
          (couponCodeCtrl.statusChanges | async) &&
          couponCodeCtrl.valid &&
          couponCodeCtrl.value
        "
        >Zastosowano żniżkę</mat-hint
      > </mat-form-field
    ><button type="button" mat-raised-button color="primary">
      Zastosuj kod
    </button>

    <button [disabled]="!checkoutForm.valid" mat-raised-button color="primary">
      Zamawiam
    </button>
  </fieldset>
</form>

<router-outlet></router-outlet>
